---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
title: "Do Voters Reward, Punish, or Ignore Party Relabeling?"
thanks: "The paper's revision history and the materials needed to reproduce its analyses can be found [on Github here](http://github.com/fsolt/relabeling). Corresponding author: [frederick-solt@uiowa.edu](mailto:frederick-solt@uiowa.edu). Current version: `r format(Sys.time(), '%B %d, %Y')`."
author:
- name: Mi-son Kim
  affiliation: University of Texas, Rio Grande Valley
- name: Frederick Solt
  affiliation: University of Iowa 
abstract: "How do we understand the electoral consequences of party name changes or relabeling? Can a political party earn more votes if it sheds its antiquated label and adopts a more appealing one? Alternatively, does relabeling confuse voters or undermine the party’s previous reputation, which leads to a negative electoral outcome? Or does it have no significant effect at all? The dominant tone in the literature of political science is that party relabeling is and should be an anomaly, causing the topic of party relabeling to receive little attention, but we confirm here that relabeling has been fairly common among European parties in post-war elections. Further, using coarsened exact matching, we estimate the causal effect (local SATT) of relabeling to gain parties approximately one percentage point of vote share on average.  This suggests that, more often than not, the many parties that have chosen to shed old names have not squandered valuable brand assets, but instead have wisely taken advantage of the benefits of relabeling."
keywords: "rebranding, behavior, political marketing"
date: "`r format(Sys.time(), '%B %d, %Y')`"
fontsize: 11pt
spacing: double
bibliography: \dummy{`r file.path(getwd(), 'relabeling')`}
biblio-style: apsr
citecolor: black
endnote: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Political parties are groups of politicians seeking to win government office under a common label [@Downs1957; @Hicken2009].
By providing choices to the electorate such as ideological programs and candidates, parties serves as "brands" in the political market.
Similar to corporate brands in the commercial market, party labels convey established reputation, serving as an information shortcut for voters [e.g., @Downs1957; @Campbell1960; @Aldrich1995; @Snyder2002].
Also, party labels provide reassurance by promising standardization and coherence of the political products the parties offer through discipline over their members in the legislature [e.g., @Cox1993; @Snyder2000].
In short, party labels give political parties meaningful identities and images as an organization.

Given such informational assets carried by party labels, it seems reasonable to expect that party relabeling or name changes is or should be rare. In fact, this view is dominant in the literature. However, a close observation reveals that party relabeling is not as rare as commonly believed. Kim and Solt (2017) show that about 28% of the parties in Europe have relabeled themselves at least once since 1945. Moreover, slightly over 3% of parties have done so three or more times. Nearly a third of the democratic elections held across Europe since 1945 have included at least one party running under a new name, about one in six had two or more renamed parties, and nearly 4% of all elections had three or more renamed parties.

How do we understand party relabeling?
Specifically, what are the electoral consequences of party relabeling?
Can a political party earn more votes if it sheds its antiquated label and adopts a more appealing one?
Alternatively, does relabeling confuse voters or undermine the party’s previous reputation, which leads to a negative electoral outcome?
Or does it have no significant effect at all?
This study aims to answer these questions.


# Parties as Vote-Maximizers

Party relabeling refers to a party name change without any substantive change in terms of ideology, membership, and other organizational aspects. Given the dominance of the party-as-brand name thesis in the literature, how do we understand party relabeling? This study argues that parties undertake relabeling simply because they believe that it is electorally beneficial for them. Although acknowledging that parties function in complicated ways with multifaceted goals (see, Harmel and Janda 1994; Strom 1990), we believe that parties are primarily concerned with vote-maximization and thus, they adopt relabeling as a rebranding strategy to win more votes. This view is in line with Mayhew’s claim that politicians are single-minded seekers of reelection and parties are formed to serve their members’ electoral needs (Mayhew 1974). Even an ideologically-driven party can achieve its policy goal only with a certain degree of electoral viability as Downs (1957) famously claims that ideology is a means to an end, which is getting votes, not an end itself.

The view that parties are fundamentally vote-seekers leads us to believe that parties change names for the purpose of maximizing the amount of votes that can possibly get in a given situation. For instance, if a party expects to suffer a serious electoral loss in an upcoming election, then it could decide to shed its existing label and create a new public face through relabeling in its endeavor to minimize its potential electoral loss. Considering that parties as organizations are conservative and strongly in favor of the status quo (Michels 1962), it is reasonable to assume that parties conduct relabeling because they see it either beneficial or inevitable at least (see, Harmel et al. 1995; Harmel and Janda 1994; Harmel and Tan 2003; Janda and Harmel 1995).

Then, through what specific mechanism can relabeling contribute to the party’s vote-maximizing goal? By changing its name, the party can create a new public face or image more vividly presented to the electorate than can be done through other changes such as ideology and other organizational changes (Ishiyama and Marshall 2017). Through relabeling, the party can make a break with the past, signaling a change. When it suffered disastrous electoral losses or is mired with severe scandals, the party could shed its tainted label to dissociate itself from its previous reputation. Relatedly to this point, relabeling can effectively signal the party’s commitment to the new image or appeals it promises to make. In short, this study proposes to consider party relabeling as a rebranding strategy parties deliberately adopt primarily motivated to improve their electoral fortunes.

# Theory
Then, how do voters react to party relabeling?
Would they reward, punish, or ignore name changes of parties? 
Due to the dominant tone in the literature of political science that party relabeling is and should be an anomaly, the topic of party relabeling has received little attention.
In order to address the questions properly, therefore, we decide to borrow some analytic tools from the discipline of business, which actively investigates the phenomenon of corporate, or brand name changes.
This approach is justified by the fact that there is a growing level of consensus that electoral politics are analogous to market transactions.
Accordingly, an increasing number of attempts are made to examine party strategy and voter behavior in elections using the marketing approaches [e.g., @Scammell1999; @Lees-Marshment2001; @Needham2006; @Nielsen2012].

The literature in business suggests that a corporate or brand name is the essence of a firm’s identity.
The firm’s identity is a long-term product and thus, it needs continuous, careful reputation maintenance effort.
For this reason, name changes are considered one of the most radical or "revolutionary" rebranding strategies in the business literature [@Stuart2004].
The risks associated with brand name changes include an identity crisis—loss of previous reputation and consumer confusion—and tremendous costs to promote and communicate the new name with consumers.
Therefore, name changes are viewed as the firm’s serious managerial decision to "start-up" reputation building based on expectations that its benefit will overcome the risks and costs associated with such a decision.
In short, relabeling is carried out when the "Reputation Start-Up Effect" is expected to be greater than the "Reputation Maintenance Effect" [@Tadelis1999].

The literature suggests that the most salient effect of name changes is its signaling effect [see, e.g., @Liu2009; @Wu2010; @Gottner2011].
By changing its name, the company conveys information to the market about changes in its vision, products or services and signals there is going to be significant changes in its future performance.
By changing its name, the company conveys information to the market about changes in its vision, products or services and signals there is going to be significant changes in its future performance.
Drawing on the signaling-effect argument of corporate and brand name changes, this study views that a political party changes its label primarily out of its effort to signal changes—--whether organizational, ideological, or merely cosmetic—--to the electorate.
It is hoped that this signaling will help electorally, in turn.
For example, parties suffering poor electoral performance are more likely to change their labels than those that performed well, presumably in an effort to dissociate themselves with the past and signal changes [@Kim2017].

In other words, party relabeling could be adopted as an effective rebranding tactic.
We expect that the "Reputation Start-Up Effect" outperforms the "Reputation Maintenance Effect" among the name-changing parties in this context.
This leads us to make the following prediction.

**Hypothesis 1**: Overall, party relabeling leads to positive abnormal returns in elections, which is not possible otherwise.

It is noted that despite lots of similarities between the electoral and the consumer market transactions, there are some discrepancies in their nature.
First of all, the market transactions between firms and consumers are continuous whereas those of parties and voters are more intermittent manifested through elections.
Secondly, the level of public interest in and awareness of party brands in general and products and services provided by parties in particular is much lower than those of commercial firms.
Because of these features of electoral politics, in order for the party to utilize relabeling as a signaling device successfully, the change needs to be conspicuous enough to awaken the awareness of the electorate.

Similarly, we expect the duration of the "brand exposure" should create differing impacts in terms of the conspicuousness of name changes. 
It is safe to argue that old labels have likely been imprinted in the memory of the electorate than relatively young labels, other considerations held constant.
As a result, relabeling conducted by the former will create larger repercussions than by the latter in general.
Accordingly, our brand exposure hypothesis follows:  

**Hypothesis 2**: The positive effect of relabeling is more pronounced when older party names are abandoned than their newer counterparts.

In line with the argument above, we predict that party size should matter.

**Hypothesis 3**: The positive effect of relabeling is greater when it is undertaken by large, mainstream parties than by small parties.

A large party by definition is the one that enjoys high publicity and thus once it changes its label, it is likely to attract more attention from the media and the public than does a small party.
These predictions find more theoretical support if one considers the credibility of changes suggested by relabeling and the party’s capability to carry out its proposed promises.
Signals provided by parties with better past performance are viewed credible more easily than the signals cued by poor performing parties.
There is a high level of uncertainty over the credibility of information conveyed by poor performing parties.
Successful past performance also indicates the party’s managerial capability to fulfill what is suggested by relabeling.
Without having displayed the capability of getting things done, or without having been able to make the electorate believe in such a capability, it is not possible the party to maintain its mainstream status in politics over an extended period of time.

In this context, we contend that party size and name age are good proxies for the credibility of signals cued by relabeling and the party’s capability to carry them out in the future.
Large, mainstream parties, by definition, refer to parties with good past performance that have been able to garner widespread support continuously from the electorate.
Thus, winning a significant vote/seat share captures the concepts of credibility and capability.
In addition, older names provide more credible cues on future performance than younger ones simply because being exposed to the electorate for long, they have already provided sufficient information about their parties' managerial skills and capabilities.
Newer party names, on the other hand, do not have this time-honored asset yet.
Voters face a higher degree of uncertainty over what the signal means and how likely it is to be materialized in the future when newer parties are shed.
For this reason, the signals provided by relabeling older names are perceived to be more credible and meaningful than those provided by abandoning newer ones.



# Data on Party Relabeling

```{r plot_setup, include=FALSE}
library(tidyverse)

load(here::here("data","new_change_data.rda")) # run data_preparation.R to generate this file
change_data <- new_change_data

change_party <- change_data %>%
  group_by(country, party) %>% 
  summarize(change_sum = sum(change)) %>%
  mutate(change_total = if_else(change_sum >=3, "3 or more", as.character(change_sum)),
         changed_ever = if_else(change_sum > 0, 1, 0))

change_election <- change_data %>%
  group_by(country, year) %>% 
  summarize(change_sum = sum(change)) %>%
  mutate(change_total = if_else(change_sum >=3, "3 or more", as.character(change_sum)))

change_country <- change_party %>%
  group_by(country) %>% 
  summarise(changed_ever = mean(changed_ever))
```

To test how voters react when parties choose to relabel themselves, we employ a revised and expanded version of the party relabeling dataset collected by @Kim2017.
Those data were scraped from Wolfram Nordsieck's [http://www.parties-and-elections.eu](Parties and Elections in Europe) website, which in turn draws on a host of country-specific resources to carefully identify the parties that contested national elections across the continent, the names they ran on, and their vote shares.
We re-scraped the @Nordsieck2018 website to include elections through 2017, and identified and corrected a few errors.
As in @Kim2017, the variable of interest, relabeling, is dichotomous and takes on a value of one when a preexisting party runs with a different name than it used in the previous election and zero otherwise.
The dataset encompasses `r dim(change_party)[1]` parties in `r dim(change_election)[1]` different elections held in 31 European democracies (the EU-27, plus Iceland, Norway, Switzerland, and the United Kingdom) during the years from 1945 through 2017, for a total of `r dim(change_data)[1]` party-election observations. 

```{r make_plots, include=FALSE}
library(scales)

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  require(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

sum_plot_party <- ggplot(change_party, aes(x = factor(change_total))) +  
  geom_bar(aes(y = (..count..)/sum(..count..))) + 
  scale_y_continuous(labels = scales::percent_format(), limits=c(0,.73)) +
  theme_bw() + coord_flip() +
  ylab("a. Relabelings per Party") + 
  theme(axis.title.y = element_blank()) 

sum_plot_election <- ggplot(change_election, aes(x = factor(change_total))) +  
  geom_bar(aes(y = (..count..)/sum(..count..))) + 
  scale_y_continuous(labels = scales::percent_format(), limits=c(0,.73)) +
  theme_bw() + coord_flip() + 
  ylab("b. Relabelings per Election") + 
  theme(axis.title.y = element_blank())

sum_plot_country <- ggplot(change_country, aes(x = changed_ever, 
                                               y = reorder(country, changed_ever)) ) + 
  geom_point() + theme_bw() +
  xlab("c. Relabeled Parties") + 
  scale_x_continuous(labels = scales::percent_format()) +
  theme(axis.title.y = element_blank())  +
  expand_limits(x = 0)

```

```{r sum_tables, include=FALSE}
#Summary Statistics Tables
table(change_party$change_total)/length(change_party$change_total)
change_party[change_party$change_sum>=3,1:4]

table(change_election$change_total)/length(change_election$change_total)
change_election %>% 
  filter(change_sum >=3) %>% 
  select(country:change_total) %>% 
  arrange(-change_sum)

summary(change_country$changed_ever)
```

```{r sum_plot, echo=FALSE, message=FALSE, fig.width=6, fig.height=4, fig.cap="\\label{fig:sum_plot}Party Relabeling Across European Democracies, 1945-2017."}

multiplot(sum_plot_party, sum_plot_election, sum_plot_country, 
          layout = matrix(c(1, 2, 3, 3), nrow=2, byrow=F))
```

These data are summarized in Figure \ref{fig:sum_plot}.
Panel (a) indicates that `r round((1 - as.vector(table(change_party$change_total)/length(change_party$change_total))[1]) * 100)`\% of parties have relabeled themselves at least once, and more than `r round( (as.vector(table(change_party$change_total)/length(change_party$change_total))[4]) * 100)`\% have done so three or more times.
Panel (b) shows that nearly two in five post-war elections in Europe included at least one party that was running with a new name for the first time.
In fact, some ten elections have featured five or more parties running with new names: in Belgium, Estonia, Lithuania, Slovakia, Slovenia, and five times in Italy.
Panel (c) underscores that relabeling is more common in some countries than in others.
Six of the nine parties to contest elections in Sweden since 1945 have changed their names one or more times, but only one of Iceland's nineteen parties did so, the _Sameiningarflokkur alþýðu – Sósíalistaflokkurinn_ (the People's Unity Party – Socialist Party) when it became the _Alþýðubandalagið_ (the People's Alliance).

```{r gen_controls, include=FALSE}
change_data1 <- change_data %>%
  group_by(country) %>% 
  mutate(first_cy = min(year),
         old_dem = as.numeric(country %in% c("Denmark", "Belgium", "Finland", "Ireland", "Luxembourg", "Netherlands", "Sweden", "United Kingdom", "Iceland", "Norway", "Switzerland"))) %>% # No authoritarian interlude of more than 10 years
  ungroup() %>% 
  arrange(country, party, year) %>% 
  group_by(country, party) %>% 
  mutate(first_pcy = min(year),
         election_pcy = as.numeric(factor(year)),
         r_avg_vote = if_else(election_pcy > 1, round((cumsum(vote_share)-vote_share)/(election_pcy - 1), 1), NA_real_),
         r_avg_vote = if_else((election_pcy == 1 & (first_pcy!=first_cy | old_dem == 0)), 0, r_avg_vote),
         prev_vote = if_else(year == first_pcy, 0, lag(vote_share)),
         prev_vote_rel = prev_vote - r_avg_vote,
         prev_vote_rel_perc = prev_vote_rel/r_avg_vote,
         prev_vote_rel_perc = if_else(r_avg_vote==0 & !is.na(prev_vote_rel), 0, prev_vote_rel_perc), # Set equal to 0 if new party
         elec_shock = -prev_vote_rel_perc,
         vote_diff = if_else(!is.na(prev_vote), abs(vote_share - prev_vote), vote_share),
         dem_age = year - first_cy,
         party_age = year - first_pcy, # years since first contested (postwar) election
         count = lag(cumsum(change)),
         count = if_else(is.na(count), 0, count)) %>% 
  group_by(country, party, count) %>% 
  mutate(name_exp = as.numeric(as.factor(year)) - 1, # brand exposure: number of previous elections name was used
         name_age = round(year) - round(min(year))) %>% 
  group_by(country) %>% 
  mutate(enep_lag = lag(enep1)) %>% 
  ungroup()

# Pedersen index of volatility
pedersen <- change_data1 %>% 
  group_by(country, year) %>% 
  summarize(pedersen = sum(vote_diff, na.rm = TRUE)/2) %>% 
  ungroup() %>% 
  group_by(country) %>% 
  mutate(pedersen_lag = lag(pedersen)) %>% 
  ungroup()

change_data2 <- change_data1 %>% 
  left_join(pedersen, by = c("country", "year")) %>% 
  rename(vote = vote_share) %>% 
  group_by(country, party) %>%
  arrange(country, party, year) %>% 
  mutate(cparty = paste(country, party) %>% str_replace_all(" ", "_") %>% tolower(),
         vote_gain_abs = vote - prev_vote,
         vote_gain_rel = if_else(prev_vote==0, 1, vote/prev_vote),
         log_party_age = log1p(party_age),
         elec_shock = elec_shock,
         lag_name_exp_p1 = lag(name_exp) + 1) %>% 
  ungroup() %>% 
  mutate(election = as.numeric(as.factor(paste(country, year)))) %>% 
  select(country, year, party, cparty, election, election_pcy,
         change, log_party_age, r_avg_vote, cabinet_party_last, 
         enep_lag, name_exp,
         lag_name_exp_p1, elec_shock, pedersen_lag, 
         vote, prev_vote, vote_gain_abs, vote_gain_rel) %>% 
  filter(complete.cases(.)) 
```


# Method

With the difficulty of acquiring data on when European parties have chosen to compete under new names surmounted, the next obstacle is to estimate the causal effect of these changes on parties' electoral fortunes.
This is not a straightforward task: @Kim2017 found support for arguments that parties that decide to relabel themselves are distinctly different from those that do not.
Specifically, parties are more likely to relabel when they have competed with their existing brand name in fewer elections ('brand exposure'), when they have suffered a more disappointing result in the immediately preceding poll ('electoral shock'), and when the preceding election was characterized by higher volitility ('party-system weakness').
Our replication of that article's analyses with our expanded dataset---which include nearly one-fourth again as many party-election observations as the original's---provide additional support for those findings (the results of this replication are presented in this paper's Appendix).

```{r all, include=FALSE}
m1 <- lme4::lmer(data = change_data2, vote_gain_abs ~ change +
                   log_party_age + 
                   r_avg_vote + 
                   cabinet_party_last + 
                   enep_lag + lag_name_exp_p1 + elec_shock + pedersen_lag +
                   (1|cparty) + (1|election) + (1|country))

m2 <- lme4::lmer(data = change_data2, vote_gain_abs ~ change +
                   log_party_age + 
                   r_avg_vote + 
                   cabinet_party_last + 
                   enep_lag + lag_name_exp_p1 + elec_shock + pedersen_lag +
                   change:lag_name_exp_p1 +
                   (1|cparty) + (1|election) + (1|country))

m3 <- lme4::lmer(data = change_data2, vote_gain_abs ~ change +
                   log_party_age + 
                   r_avg_vote + 
                   cabinet_party_last + 
                   enep_lag + lag_name_exp_p1 + elec_shock + pedersen_lag +
                   change:r_avg_vote +
                   (1|cparty) + (1|election) + (1|country))
```

```{r cem_all, include=FALSE}
library(cem)

dat2 <- change_data2 %>%
  mutate(country = as.factor(country),
         change_big = as.numeric(change==1 & r_avg_vote > 6.45),
         change_small = as.numeric(change==1 & r_avg_vote <= 6.45),
         change_old = as.numeric(change==1 & lag_name_exp_p1 >= 2),
         change_new = as.numeric(change==1 & lag_name_exp_p1 < 2)) %>% 
  as.data.frame()

to_exclude1 <- c("vote", "vote_gain_abs", "vote_gain_rel", "year", "election", "election_pcy", "party", "cparty", "change", "country")

to_exclude2 <- c("vote", "vote_gain_abs", "vote_gain_rel", "year", "election", "election_pcy", "party", "cparty", "country", "change", "change_big", "change_small", "change_new", "change_old")

imb1 <- imbalance(group = change_data2$change, 
                  data = dat2, 
                  drop = to_exclude2)

mat1 <- cem(treatment = "change", 
            data = dat2, 
            drop = to_exclude2, 
            keep.all = TRUE)

est1 <- att(mat1, 
            vote_gain_abs ~ change +
              log_party_age + 
              r_avg_vote + 
              cabinet_party_last + 
              enep_lag + lag_name_exp_p1 + elec_shock + pedersen_lag,
            data = dat2,
            model = "lme")
```

In other words, the treatment of a new party name is not assigned randomly among party-election observations, our observational data therefore are not similar to those generated by an experiment.
Far from it, actually: the multivariate imbalance measure $L_1$ [see @Iacus2012, 7] between party-elections with and without a new party name on the variables included in the @Kim2017 model is 98%, indicating that the distributions of these pre-treatment variables between these two groups of observations scarcely overlap.
Such imbalance increases statistical bias and model dependence, and differences in the vote shares of parties with new and old labels cannot be interpreted as causal effects.
We can, however, approximate an experiment by preprocessing the data with coarsened exact matching (CEM) so as to ensure that we compare relabeling parties directly with otherwise similar parties that did not adopt a new name [see @Iacus2012].

CEM allows researchers to trade off sample size for improved balance, reduced bias, and decreased model dependence.
We employ the `cem` package for R [@Iacus2018] to perform the matching.
The result is a dataset that retains 87 party-election observations of relabeling (out of an original 324), matched to 138 observations (out of an original 2878) in which no relabeling occurred.
As there is no reasonable match for many, many cases of relabeling, our estimand will be only the _local_ sample average treatment on the treated (local _SATT_), the treatment effect averaged only over the subset of observations with a match given the available controls [see @Iacus2012, 5].

Because coarsened exact matching proceeds first by binning ("coarsening") continuous control variables, some differences among treated and untreated observations remain, and it is appropriate to control for these remaining differences statistically [@Iacus2012, 4-5].
We therefore employ linear mixed-effects models, with random effects estimated for each strata, and include all of the controls variables used in @Kim2017.
To test Hypothesis 2 on the conditional effect of relabeling by the brand exposure of the discarded name and Hypothesis 3 on that by party size, we rely on splitting our sample at the median value of each of these variables.

```{r cem_name_exp, include=FALSE}
mat2a <- cem(treatment = "change_old", 
             data = dat2, 
             drop = to_exclude2, 
             keep.all = TRUE)

est2a <- att(mat2a, 
             vote_gain_abs ~ change_old +
               log_party_age + 
               r_avg_vote + 
               cabinet_party_last + 
               lag_name_exp_p1 + elec_shock + pedersen_lag,
             data = dat2,
             model = "lme")

mat2b <- cem(treatment = "change_new", 
             data = dat2, 
             drop = c(to_exclude2, "cabinet_party_last"), 
             keep.all = TRUE)

est2b <- att(mat2b, 
             vote_gain_abs ~ change_new +
               log_party_age + 
               r_avg_vote + 
               lag_name_exp_p1 + elec_shock + pedersen_lag,
             data = dat2,
             model = "lme")
```

```{r cem_r_avg_vote, include=FALSE}
mat3a <- cem(treatment = "change_big", 
             data = dat2, 
             drop = to_exclude2, 
             keep.all = TRUE)

est3a <- att(mat3a, 
             vote_gain_abs ~ change_big +
               log_party_age + 
               r_avg_vote + 
               cabinet_party_last + 
               lag_name_exp_p1 + elec_shock + pedersen_lag,
             data = dat2,
             model = "lme")

mat3b <- cem(treatment = "change_small", 
             data = dat2, 
             drop = c(to_exclude2, "cabinet_party_last"), 
             keep.all = TRUE)

est3b <- att(mat3b, 
             vote_gain_abs ~ change_small +
               log_party_age + 
               r_avg_vote + 
               cabinet_party_last + 
               lag_name_exp_p1 + elec_shock + pedersen_lag,
             data = dat2,
             model = "lme")
```

```{r results_plot, echo=FALSE, message=FALSE, fig.width=6, fig.height=4, fig.cap="\\label{fig:results_plot}Local Sample Average Treatment Effect of Party Relabeling on Vote Share"}
extract_results <- function(est, model_name) {
  tibble(term = "Relabeling",
         estimate = est$att.model["Estimate", 2],
         std.error = est$att.model["Std. Error", 2],
         model = model_name)
}

bind_rows(
  extract_results(est1, "Relabeling, All Matched Parties"),
  extract_results(est2a, "Abandoning Older Brands"),
  extract_results(est2b, "Abandoning Newer Brands"),
  extract_results(est3a, "Larger Parties"),
  extract_results(est3b, "Smaller Parties")
) %>% 
  dotwhisker::secret_weapon(var = "Relabeling") +
  theme_bw() +
  theme(legend.position="none") +
  geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
  xlab("Difference in Vote Share (%)")

```

# Results

The results are presented in Figure \ref{fig:results_plot}.
They show that among all of the matched parties, relabeling had the effect of boosting vote share by nearly one percentage point, $.92\pm.09$ supporting Hypothesis 1.
There is also support, albeit more modest, for Hypothesis 2.
The median party name had been used twice previously.
Among the 36 matched parties that abandoned names that had been used twice or more times, the vote share gain was $1.24\pm.28$, while for the 62 matched parties that abandoned a name used only once previously, the electoral benefit was only $.74\pm.15$.
The difference between the two groups is $.50\pm.31$, which yields a one-tailed $p$-value (appropriate given the directional hypothesis) of .055.
There is no support at all for Hypothesis 3.
The 29 matched parties with average vote shares in the elections they had contested prior that were larger than the sample median, 6.45%, gained an average of $.92\pm.28$ percentage points by relabeling.
The benefit of relabeling for the 68 matched smaller parties was $1.02\pm.09$ percentage points, a basically identical amount.

\pagebreak
\appendix
\renewcommand\thefigure{A\arabic{figure}}  
\renewcommand\thetable{A\arabic{table}} 
\setcounter{figure}{0} 
# Appendix: Replication of @Kim2017

```{r replication, include=FALSE}
library(lme4)

base_model <- "log_party_age + 
                r_avg_vote + 
                cabinet_party_last + 
                enep_lag"

# base model
t1m0 <- glmer(as.formula(paste("change ~", base_model, " +
                (1|cparty) + (1|election) + (1|country)")),
              data = change_data2, family = "binomial", nAGQ = 0)

# brands
t1m1 <- glmer(as.formula(paste("change ~", base_model, "+ name_exp +
                (1|cparty) + (1|election) + (1|country)")),
              data = change_data2, family = "binomial", nAGQ = 0)

# shocks
t1m2 <- glmer(as.formula(paste("change ~", base_model, "+ elec_shock +
                (1|cparty) + (1|election) + (1|country)")),
              data = change_data2, family = "binomial", nAGQ = 0)

# volatility 
t1m3 <- glmer(as.formula(paste("change ~", base_model, "+ pedersen_lag +
                (1|cparty) + (1|election) + (1|country)")),
              data = change_data2, family = "binomial", nAGQ = 0)

# all three 
t1m4 <- glmer(as.formula(paste("change ~", base_model, "+ name_exp + elec_shock + pedersen_lag +
                (1|cparty) + (1|election) + (1|country)")),
              data = change_data2, family = "binomial", nAGQ = 0)

```


```{r replication_table, results = 'asis', echo=FALSE, message=FALSE, warning=FALSE}
library(texreg)

format_for_texreg <- function(model = NULL) {
  model.res <- texreg::extract(model, include.aic=F, include.bic=F, include.deviance=F, naive=T)
  model.res@gof <- model.res@gof[-9]
  model.res@gof.names <- model.res@gof.names[-9]
  model.res@gof.decimal <- model.res@gof.decimal[-9]
  return(model.res)
}

models.t1 <- list()
for (i in 1:4) {
  models.t1[i] <- format_for_texreg(get(paste0("t1m", i)))
}

vars <- c("Party Age, Logged", "Party Size", "Incumbent Government", "Electoral Pluralism",  "Brand Exposure", "Electoral Shock", "Party System Weakness")


# Three Theories
texreg::texreg(l=models.t1, label="T:models.t1", 
               caption="Predicting Party Relabeling, Cross-Classified Hierarchical Models, Replicating Kim and Solt (2017, 442, Table 1)",
               stars = c(0.001, 0.01, 0.05, 0.1), symbol="\\dagger",
               #caption.above=T, 
               custom.coef.names=c("Intercept", vars),  
               custom.gof.names = c(NA, "Party-Elections", "Parties", "Elections", "Countries", "Variance: Parties", "Variance: Elections", "Variance: Countries"),
               reorder.coef = c(6:8, 2:5, 1),
               float.pos = "h"
)
```


```{r replication_plot, echo=FALSE, fig.cap="\\label{fig:replication_plot}First Differences in Predicted Probability of Party Relabeling, Replicating Kim and Solt (2017, 443, Figure 2)."} 
sims.glmer <- function(mod = NULL, n = 10000, seed = 324) {
  # H/T http://www.quantumforest.com/2011/10/simulating-data-following-a-given-covariance-structure/
  varcov <- matrix(vcov(mod)@x, nrow = vcov(mod)@Dim[1])
  betas <- fixef(mod)
  se <- diag(chol(diag(diag(varcov), length(diag(varcov)))))
  
  L <- chol(varcov)
  n.vars <- dim(L)[1]
  
  set.seed(seed)
  sims <- t(t(L) %*% matrix(rnorm(n.vars*n), nrow=n.vars, ncol=n))
  
  for (v in 1:ncol(sims)) {
    sims[,v] <- sims[,v] + as.numeric(betas[v])
  }
  
  sims <- as.data.frame(sims)
  names(sims) <- names(betas)
  names(sims)[1] <- "constant"
  return(sims)
}

# glmer.logit.fd, which calculates first differences when all other variables are at their means, is used only for comparison to glmer.logit.fd2, which uses the sample mean of the DV as the baseline instead to compensate for the underprediction that occurs when the DV is relatively rare

glmer.logit.fd <- function(mod = NULL, sdX2 = FALSE, use.mode = FALSE, ci = .95) {
  mod.sims <- sims.glmer(get(mod))
  mod <- get(mod)
  
  df <- cbind( constant = 1, mod@frame[, 2:(length(mod@frame) - length(mod@cnms))])
  vars.mean <- data.frame(t(colMeans(df)))
  vars <- names(df)
  if (use.mode == TRUE) {
    for(i in seq(length(vars))) {
      tab <- table(df[, vars[i]])
      if (length(tab) == 2) {
        vars.mean[i] <- as.numeric(names(tab[which(tab == max(tab))]))
      }
    }
  }
  fd <- data.frame(mean = t(vars.mean), min = NA, max = NA, fd = NA, fd.lb = NA, fd.ub = NA)
  for(i in seq(length(vars))) {
    fake.data <- data.frame(vars.mean[, !names(vars.mean) %in% vars[i]], 
                            x = c(min(df[vars[i]]), max(df[vars[i]])))
    fd[i, "min"] <- min(df[vars[i]])
    fd[i, "max"] <- max(df[vars[i]])            
    if (sdX2 == TRUE & length(table(df[, vars[i]])) > 2) {
      fake.data$x <- c(mean(df[, vars[i]]) - sd(df[, vars[i]]), 
                       mean(df[, vars[i]]) + sd(df[, vars[i]]))
      fd[i, "min"] <- mean(df[, vars[i]]) - sd(df[, vars[i]])
      fd[i, "max"] <- mean(df[, vars[i]]) + sd(df[, vars[i]])  
    }
    names(fake.data)[length(names(fake.data))] <- vars[i]
    sims.t <- mod.sims[c(vars[!vars %in% vars[i]], vars[i])]
    t <- plogis(data.matrix(fake.data) %*% t(data.matrix(sims.t)))
    diff <- t[2,] - t[1,]
    
    fd[i, 4] <- mean(diff)*100
    fd[i, 5:6] <- quantile(diff, probs = c(0.025, 0.975))*100
  }
  return(fd)
}

glmer.logit.fd2 <- function(model = NULL, sdX2 = FALSE, use.mode = FALSE, ci = .95) {
  mod.sims <- sims.glmer(get(model))
  mod <- get(model)
  
  df <- cbind( constant = 1, mod@frame[, 2:(length(mod@frame) - length(mod@cnms))])
  vars.mean <- data.frame(t(colMeans(df)))
  vars <- names(df)
  if (use.mode == TRUE) {
    for(i in seq(length(vars))) {
      tab <- table(df[, vars[i]])
      if (length(tab) == 2) {
        vars.mean[i] <- as.numeric(names(tab[which(tab == max(tab))]))
      }
    }
  }
  fd <- data.frame(mean = t(vars.mean), min = NA, max = NA, fd = NA, fd.lb = NA, fd.ub = NA)
  for(i in seq(length(vars))) {
    fake.data <- data.frame(x = c(min(df[vars[i]]), max(df[vars[i]])))
    fd[i, "min"] <- min(df[vars[i]])
    fd[i, "max"] <- max(df[vars[i]])            
    if (sdX2 == TRUE & length(table(df[, vars[i]])) > 2) {
      fake.data$x <- c(mean(df[, vars[i]]) - sd(df[, vars[i]]), 
                       mean(df[, vars[i]]) + sd(df[, vars[i]]))
      fd[i, "min"] <- mean(df[, vars[i]]) - sd(df[, vars[i]])
      fd[i, "max"] <- mean(df[, vars[i]]) + sd(df[, vars[i]])  
    }
    names(fake.data) <- vars[i]
    sims.t <- mod.sims[vars[i]]
    pp <- t(qlogis(mean(mod@frame$change)) - fd[i, "mean"]*data.matrix(sims.t)) 
    pp <- rbind(pp, pp)
    pp <- plogis(pp + data.matrix(fake.data) %*% t(data.matrix(sims.t)))
    diff <- pp[2,] - pp[1,]
    
    fd[i, 4] <- mean(diff)*100
    fd[i, 5:6] <- quantile(diff, probs = c(0.025, 0.975))*100
  }
  return(fd)
}

t1m4.fd.range <- glmer.logit.fd2("t1m4")
t1m4.fd.sdX2 <- glmer.logit.fd2("t1m4", sdX2 = T)

fd.cust <- function(model = NULL, iv = NULL, range = c(0, 1), digits=0) {
  mod.sims <- sims.glmer(get(model))
  mod <- get(model)
  sims.t <- mod.sims[iv]
  fake.data <- data.frame(iv = range)
  pp <- t(qlogis(mean(mod@frame$change)) - mean(mod@frame[[iv]])*data.matrix(sims.t)) 
  pp <- rbind(pp, pp)
  pp <- plogis(pp + data.matrix(fake.data) %*% t(data.matrix(sims.t)))
  diff <- pp[2,] - pp[1,]
  fd <- mean(diff)*100
  fd <- c(fd, quantile(diff, probs = c(0.025, 0.975))*100)
  out <- paste(round(fd[1], digits), "percentage points (95\\% C.I.,", round(fd[2], digits), "to", round(fd[3], digits),"points)")
  out
}

t1m4.fd <- rbind(data.frame(iv = row.names(t1m4.fd.sdX2)[c(6:8, 2:5)], 
                            t1m4.fd.sdX2[c(6:8, 2:5), 4:6], 
                            range = "Over 2 Standard Deviations",
                            no = 1:length(row.names(t1m4.fd.sdX2)[-1])),
                 data.frame(iv = row.names(t1m4.fd.range)[c(6:8, 2:5)], 
                            t1m4.fd.range[c(6:8, 2:5), 4:6], 
                            range = "Over Full Range",
                            no = 1:length(row.names(t1m4.fd.range)[-1])) 
)

n.vars <- length(row.names(t1m4.fd.sdX2)[-1])

fd.plot <- ggplot(data = t1m4.fd, aes(y = no, x = fd)) +
  geom_point() + geom_errorbarh(aes(xmin = fd.lb, xmax = fd.ub, height=0)) +
  ylab("") + xlab("") + theme_bw() + 
  scale_y_reverse(breaks = 1:n.vars, labels = vars[c(5:7, 1:4)]) +
  theme(legend.title=element_blank(), legend.position=c(.15, .95)) +
  geom_vline(xintercept=c(0), linetype="dotted") + 
  facet_grid(. ~ range, scales="free") +
  scale_x_continuous(breaks = seq(-60, 50, by = 10))

fd.plot
```


\pagebreak
# References
